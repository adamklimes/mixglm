<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Case Study • mixglm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Case Study">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mixglm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/mixglm.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/caseStudy.html">Case Study</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Case Study</h1>
            <h3 data-toc-skip class="subtitle">Contents</h3>
            
      

      <div class="d-none name"><code>caseStudy.Rmd</code></div>
    </div>

    
    
<p>This is an article illustrating the use of <em>mixglm</em> package on
a case study. For a more technical illustration of the package
functionality, see <code><a href="../articles/mixglm.html">vignette("mixglm")</a></code> (<em>mixglm</em> has
to be installed with vignettes).<br><br></p>
<div class="section level2">
<h2 id="tree-cover-in-south-america">Tree cover in South America<a class="anchor" aria-label="anchor" href="#tree-cover-in-south-america"></a>
</h2>
<p>The case study replicates analyses by Hirota et
al. (<a name="bHirota"></a><a href="#refHirota">2011</a>) and Flores et
al. (<a name="bFlores"></a><a href="#refFlores">2024</a>). These two
studies model tree cover for most of South America and for the Amazon
respectively along a precipitation gradient. The used tree cover data is
from 2001. Replication of the analysis here is done using tree cover for
the year 2025 for the whole of South America.<br><br></p>
<div class="section level3">
<h3 id="tree-cover-dataset">Tree cover dataset<a class="anchor" aria-label="anchor" href="#tree-cover-dataset"></a>
</h3>
<p><em>mixglm</em> package provides the dataset <code>treeCover</code>
which includes tree cover, precipitation, temperature, and predicted
precipitation for the end of 21st century and coordinates for 5,000
data-points across South America.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://adamklimes.github.io/mixglm/">mixglm</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: nimble</span></span>
<span><span class="co">#&gt; nimble version 1.3.0 is loaded.</span></span>
<span><span class="co">#&gt; For more information on NIMBLE and a User Manual,</span></span>
<span><span class="co">#&gt; please visit https://R-nimble.org.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Note for advanced users who have written their own MCMC samplers:</span></span>
<span><span class="co">#&gt;   As of version 0.13.0, NIMBLE's protocol for handling posterior</span></span>
<span><span class="co">#&gt;   predictive nodes has changed in a way that could affect user-defined</span></span>
<span><span class="co">#&gt;   samplers in some situations. Please see Section 15.5.1 of the User Manual.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'nimble'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     simulate</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     declare</span></span>
<span></span>
<span><span class="co"># See ?treeCover for additional information </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">treeCover</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    5000 obs. of  6 variables:</span></span>
<span><span class="co">#&gt;  $ x         : num  -47.7 -70.5 -61 -54.7 -69.8 ...</span></span>
<span><span class="co">#&gt;  $ y         : num  -24.47 -14.57 -10 2.97 -18.56 ...</span></span>
<span><span class="co">#&gt;  $ treeCover : num  74.51 5.44 79.71 68.72 1.42 ...</span></span>
<span><span class="co">#&gt;  $ precip    : num  1917 1272 2096 2514 242 ...</span></span>
<span><span class="co">#&gt;  $ temp      : num  22.21 6.67 25.58 25.88 15.45 ...</span></span>
<span><span class="co">#&gt;  $ precip2100: num  1627 1317 1580 1544 876 ...</span></span></code></pre></div>
<p>In this case study, we model the stability landscape for tropical
forests and savanna alternative states along precipitation and
temperature gradients. There are only a few observations with very high
precipitation and very low temperature. This prevents us from estimating
reliably the stability landscape for these parts of respective
gradients. Therefore, we constrain the analyses to the well-represented
parts of precipitation (below 4000 mm/yr) and temperature gradients
(over 0°C).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">treeCover</span><span class="op">$</span><span class="va">treeCover</span> <span class="op">~</span> <span class="va">treeCover</span><span class="op">$</span><span class="va">precip</span>, cex <span class="op">=</span> <span class="fl">0.1</span>, ylab <span class="op">=</span> <span class="st">"Tree cover (%)"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Precipitation (mm/yr)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">4000</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="caseStudy_files/figure-html/dataSelection-1.png" width="672"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">treeCover</span><span class="op">$</span><span class="va">treeCover</span> <span class="op">~</span> <span class="va">treeCover</span><span class="op">$</span><span class="va">temp</span>, cex <span class="op">=</span> <span class="fl">0.1</span>, ylab <span class="op">=</span> <span class="st">"Tree cover (%)"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Temperature (°C)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="caseStudy_files/figure-html/dataSelection-2.png" width="672"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datTC</span> <span class="op">&lt;-</span> <span class="va">treeCover</span><span class="op">[</span><span class="va">treeCover</span><span class="op">$</span><span class="va">precip</span> <span class="op">&lt;</span> <span class="fl">4000</span> <span class="op">&amp;</span> <span class="va">treeCover</span><span class="op">$</span><span class="va">temp</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="op">]</span> <span class="co"># 4860 observations</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="stability-landscape-along-precipitation-gradient">Stability landscape along precipitation gradient<a class="anchor" aria-label="anchor" href="#stability-landscape-along-precipitation-gradient"></a>
</h3>
<p>First, we model the stability landscape along the precipitation
gradient. Tree cover has an upper (100%) as well as lower (0%) limit,
therefore we will use a beta mixture rather than a Gaussian (normal). A
beta-distributed variable can have values from 0 to 1 (excluding 0 and
1). Thus, we calculate the proportion of tree cover and shift the values
slightly to make sure the dataset does not contain any exact zeros or
ones. We also standardize predictors to 0 mean and standard deviation 1
to facilitate the model fit (and ensure the same effect of priors once
we use multiple predictors).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">squeeze</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">*</span> <span class="fl">0.98</span> <span class="op">+</span> <span class="fl">0.01</span></span>
<span><span class="va">datTC</span><span class="op">$</span><span class="va">treeCoverProp</span> <span class="op">&lt;-</span> <span class="fu">squeeze</span><span class="op">(</span><span class="va">datTC</span><span class="op">$</span><span class="va">treeCover</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">st</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span> <span class="op">=</span> <span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">datTC</span><span class="op">$</span><span class="va">precipSt</span> <span class="op">&lt;-</span> <span class="fu">st</span><span class="op">(</span><span class="va">datTC</span><span class="op">$</span><span class="va">precip</span><span class="op">)</span></span>
<span><span class="va">datTC</span><span class="op">$</span><span class="va">tempSt</span> <span class="op">&lt;-</span> <span class="fu">st</span><span class="op">(</span><span class="va">datTC</span><span class="op">$</span><span class="va">temp</span><span class="op">)</span></span></code></pre></div>
<p>We need to specify the number of components in the mixture. We should
use more components than is the number of expected stable states because
each stable state can be modeled using multiple components (resulting
e.g. in a wider basin). Since the probability of each component in the
mixture is estimated, unnecessary components will have a probability
close to zero and will be effectively suppressed. We could select the
number of components based on an Watanabe-Akaike information criterion
(WAIC; <a name="bWatanabe"></a><a href="#refWatanabe">Watanabe,
2013</a>) by running the model with different numbers of components and
selecting the one with the lowest WAIC. However, estimates of WAIC are
sometimes unstable for mixture models. In conclusion, we recommend using
a high number of components and ensure that results are not affected by
adding or excluding a component. In this example, we use 7 components.
We also limit the number of chains to just 2 (for illustration purposes)
to make the fit quicker (the following model fit can take up to a few
hours).</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adam Klimes.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
